---
description: Rules for BingoSim.Shared project.
globs: ["BingoSim.Shared/**/*.cs"]
alwaysApply: false
---

# Shared Layer Guidelines

The Shared project contains common models and utilities used by multiple layers (Web and Worker).

## Content

### Message Contracts
DTOs for messaging between Web and Worker:

```csharp
namespace BingoSim.Shared.Messages;

public record SimulationJobMessage(
    Guid SimulationId,
    int Iterations,
    BingoCardConfiguration CardConfig);

public record SimulationCompletedMessage(
    Guid SimulationId,
    int TotalWins,
    int TotalIterations,
    TimeSpan Duration);
```

### Constants
Shared constant values:

```csharp
namespace BingoSim.Shared;

public static class BingoConstants
{
    public const int StandardCardSize = 25;
    public const int MinNumber = 1;
    public const int MaxNumber = 75;

    public const int MaxIterations = 1_000_000;
    public const int DefaultIterations = 10_000;
}

public static class QueueNames
{
    public const string SimulationJobs = "simulation-jobs";
    public const string SimulationResults = "simulation-results";
}
```

### Utilities
General-purpose extension methods:

```csharp
namespace BingoSim.Shared.Extensions;

public static class EnumerableExtensions
{
    public static IEnumerable<T> Shuffle<T>(this IEnumerable<T> source)
    {
        var random = new Random();
        return source.OrderBy(_ => random.Next());
    }

    public static IEnumerable<IEnumerable<T>> Chunk<T>(this IEnumerable<T> source, int size)
    {
        var list = source.ToList();
        for (int i = 0; i < list.Count; i += size)
        {
            yield return list.Skip(i).Take(size);
        }
    }
}
```

## Critical Constraints
- **Minimal Dependencies**: Keep lightweight. No EF Core, MassTransit, or other heavy frameworks
- **No Business Logic**: Business logic belongs in `Core` or `Application`
- **Data Transfer Only**: DTOs, constants, and simple utilities only

## Testing
- Utility methods **MUST** be unit tested
- Create `Tests/BingoSim.Shared.Tests` if needed
- DTOs typically don't need tests (unless they have validation logic)
